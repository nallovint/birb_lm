<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BirbLM â€¢ Document Chat</title>
  <link rel="stylesheet" href="/style.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" />
</head>
<body>
  <div class="container">
    <nav class="topnav">
      <div class="brand">BirbLM</div>
      <div class="nav-links">
        <a href="/" class="link">Landing</a>
        <a href="/chat.html" class="link active" aria-current="page">Chat</a>
        <a href="/settings.html" class="link">Settings</a>
        <a href="/rag.html" class="link">RAG</a>
        <a href="/help.html" class="link">Help</a>
      </div>
      <span class="spacer"></span>
      <span id="provider" class="provider-badge"></span>
    </nav>
    <header>
      <h1>ðŸ““ BirbLM â€“ Document Chat</h1>
      <div class="controls">
        <button id="ingest-btn">Rebuild index from docs/</button>
        <span id="status"></span>
        <div class="progress" aria-hidden="true" style="flex:1; max-width:280px;">
          <div id="ingest-bar" class="progress-bar" style="width:0%"></div>
        </div>
      </div>
    </header>

    <main class="layout" id="main-layout">
      <aside id="sidebar-col" class="doc-select">
        <div id="doc-select-block" class="doc-select-inner">
          <h3>Select documents</h3>
          <div id="doc-list" class="doc-list">Loading...</div>
          <button id="lock-selection" class="lock-btn">Use selected</button>
        </div>
        <div id="history-pane" class="history-pane">
          <div style="display:flex; align-items:center; justify-content: space-between; gap:8px;">
            <h4 style="margin:10px 0 6px 0;">Recent Chats</h4>
            <button id="new-chat" class="btn-secondary" type="button" title="Start a new chat">New Chat</button>
          </div>
          <div id="history-list" class="history-list">No history yet.</div>
        </div>
      </aside>
      <div class="chat-col">
        <div id="chat"></div>
        <div id="suggestions" style="display:flex; gap:8px; flex-wrap:wrap; margin:10px 0;"></div>
        <div class="input">
          <textarea id="query" rows="3" placeholder="Ask a question about your documents..."></textarea>
          <button id="send">Send</button>
        </div>
      </div>
      <aside id="summary-panel" class="summary-panel">
        <div style="background:#121826; border:1px solid #1d2536; border-radius:10px; padding:12px;">
          <h3 style="margin:0 0 8px 0;">Document Summary</h3>
          <div id="summary" style="font-size:0.95em; opacity:0.95;">
            Loading summary...
          </div>
        </div>
      </aside>
    </main>
  </div>

  <!-- Markdown renderer and sanitizer -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/common.min.js"></script>
  <script>
    if (window.marked) {
      marked.setOptions({
        gfm: true,
        breaks: true,
        highlight: (code, lang) => {
          try {
            if (window.hljs) {
              if (lang && hljs.getLanguage(lang)) {
                return hljs.highlight(code, { language: lang }).value;
              }
              return hljs.highlightAuto(code).value;
            }
          } catch {}
          return code;
        }
      });
    }
  </script>
  <script src="/app.js"></script>
</body>
</html>


